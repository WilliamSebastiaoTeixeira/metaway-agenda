import{R as N,aU as h,aV as z,D as w,b as f,o as U,aM as M,i as u,w as y,Y as x,V as m,U as g,aR as B,T as L,H as A,x as R,f as S,j as C,Z as j,_ as E,$,aW as I}from"./index.451ac893.js";import{_ as Q}from"./Index.845cdedc.js";import{a as _,m as F,s as D,u as T}from"./index.6476bc03.js";const Z={key:0,class:"column"},H=N({__name:"Index",props:h({required:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(b,{expose:P}){const s=z(b,"modelValue"),c=b,d=w(!0),l=w(!0),p=w(!0),o=w(""),i=f(()=>{var r,e;return{password:(r=s.value)==null?void 0:r.password,newPassword:(e=s.value)==null?void 0:e.newPassword,confirmationPassword:o==null?void 0:o.value}}),V=f(()=>{var r;return{password:{required:_(()=>{var e,a;return!!o.value.trim()||c.required||!!((a=(e=s.value)==null?void 0:e.newPassword)!=null&&a.trim())})},newPassword:{required:_(()=>{var e,a;return!!o.value.trim()||c.required||!!((a=(e=s.value)==null?void 0:e.password)!=null&&a.trim())}),minLength:F(8),lettersAndNumbers:()=>{var e;return t((e=s.value)==null?void 0:e.newPassword)}},confirmationPassword:{required:_(()=>{var e,a,k,q;return!!((a=(e=s.value)==null?void 0:e.newPassword)!=null&&a.trim())||!!((q=(k=s.value)==null?void 0:k.password)!=null&&q.trim())}),minLength:F(8),sameAsPassword:D((r=i.value.newPassword)==null?void 0:r.trim()),lettersAndNumbers:()=>{var e,a;return t((a=(e=s.value)==null?void 0:e.newPassword)==null?void 0:a.trim())}}}}),n=T(V,i),v=f(()=>!n.value.$invalid);function t(r){return r?/(?=.*[0-9])(?=.*[A-Za-z])/.test(r):!0}return P({valid:v}),(r,e)=>s.value?(U(),M("div",Z,[u(g,{modelValue:s.value.password,"onUpdate:modelValue":e[1]||(e[1]=a=>s.value.password=a),label:"Senha atual",type:d.value?"password":"text","lazy-rules":"",dense:"",outlined:"",rules:[()=>!m(n).password.required.$invalid||"Campo obrigat\xF3rio"]},{append:y(()=>[u(x,{name:d.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[0]||(e[0]=a=>d.value=!d.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),u(g,{modelValue:s.value.newPassword,"onUpdate:modelValue":e[3]||(e[3]=a=>s.value.newPassword=a),label:"Nova senha",type:l.value?"password":"text","lazy-rules":"",dense:"",outlined:"",rules:[()=>!m(n).newPassword.required.$invalid||"Campo obrigat\xF3rio",()=>!m(n).newPassword.minLength.$invalid||"Tamanho m\xEDnimo de 8 caracteres",()=>!m(n).newPassword.lettersAndNumbers.$invalid||"Precisa conter letras e n\xFAmeros"]},{append:y(()=>[u(x,{name:l.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[2]||(e[2]=a=>l.value=!l.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),u(g,{modelValue:o.value,"onUpdate:modelValue":e[5]||(e[5]=a=>o.value=a),label:"Confirmar nova senha",type:p.value?"password":"text",dense:"",outlined:"","lazy-rules":"",rules:[()=>!m(n).confirmationPassword.required.$invalid||"Campo obrigat\xF3rio",()=>!m(n).confirmationPassword.sameAsPassword.$invalid||"Senhas n\xE3o conferem",()=>!m(n).confirmationPassword.minLength.$invalid||"Tamanho m\xEDnimo de 8 caracteres",()=>!m(n).confirmationPassword.lettersAndNumbers.$invalid||"Precisa conter letras e n\xFAmeros"]},{append:y(()=>[u(x,{name:p.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[4]||(e[4]=a=>p.value=!p.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"])])):B("",!0)}}),O=C("div",{class:"row justify-start q-mb-md"},[C("span",{class:"text-h6 text-bold text-grey-9"},"Meu Cadastro")],-1),W={class:"row justify-end"},K=N({__name:"MeuCadastro",setup(b){const P=L(),s=w(),c=w(),d=w(!1),l=f(()=>P.usuario),p=f(()=>{var v,t;return!!((v=s.value)!=null&&v.valid)&&!!((t=c.value)!=null&&t.valid)}),o=A({cpf:"",dataNascimento:"",email:"",id:0,nome:"",password:"",telefone:"",username:""}),i=A({password:"",newPassword:""});async function V(){if(!l.value)return;const{object:v}=await $.usuario.buscar.get(l.value.id);Object.assign(o,v.usuario)}async function n(){try{d.value=!0,await $.usuario.atualizar.put(o),l.value&&P.setUsuario({...l.value,username:o.username}),i.password&&i.newPassword&&await $.usuario.alterarSenha.post({newPassword:i.newPassword,password:i.password,username:o.username}),I.create({message:"Usuario atualizado com sucesso",position:"bottom",type:"positive"})}finally{d.value=!1}}return R(V),(v,t)=>(U(),S(E,{padding:"",class:"container"},{default:y(()=>[O,u(Q,{ref_key:"usuarioFormRef",ref:s,modelValue:o,"onUpdate:modelValue":t[0]||(t[0]=r=>o=r)},null,8,["modelValue"]),u(H,{ref_key:"passwordFormRef",ref:c,modelValue:i,"onUpdate:modelValue":t[1]||(t[1]=r=>i=r)},null,8,["modelValue"]),C("div",W,[u(j,{"no-caps":"",unelevated:"",color:"secondary",label:"Salvar",disable:!p.value,loading:d.value,onClick:n},null,8,["disable","loading"])])]),_:1}))}});export{K as default};
