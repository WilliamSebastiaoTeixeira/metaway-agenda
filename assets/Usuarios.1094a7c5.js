import{T as L,a$ as R,b0 as re,a6 as G,o as m,aF as D,j as o,w as t,W as x,aI as P,aH as I,aG as F,i as b,a_ as q,a8 as Q,_ as w,k as c,b9 as T,aJ as ue,Z,a9 as de,ba as ce,bb as me,aN as pe,E as y,g as fe,aD as U,I as J,e as C,x as X,Q as ve,bc as z,al as A,aA as ge,V as Y,N as B,v as _e}from"./index.1bd17f9f.js";import{Q as be}from"./QPage.44845a9d.js";import{u as ee,c as ye,Q as S,b as K,a as M,d as he}from"./QItemLabel.878bcf0b.js";import{Q as xe,a as we,b as ke,c as Ve,d as Ce,l as Ee}from"./QTable.ab9fa8b6.js";import{a as j}from"./index.84463fae.js";import{a as qe,m as Qe,u as $e}from"./index.aa15f73d.js";import{_ as Ne}from"./Index.c243794c.js";import"./_commonjsHelpers.4e997714.js";import"./QMenu.55262566.js";import"./format.959830d0.js";import"./axios.3efcaa6a.js";const De={key:0},Ue={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition"},Se=c("span",{class:"text-grey-7 text-body2"}," Nenhum usu\xE1rio encontrado ",-1),Te=L({__name:"Table",props:R({loading:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:R(["editar"],["update:modelValue"]),setup(e,{emit:s}){const l=e,r=s,n=re(e,"modelValue"),v=ee(),{mobileOrSmallWidth:_}=G(v),p=[{name:"nome",label:"Nome",align:"left",field:a=>a.nome},{name:"username",label:"Username",align:"left",field:a=>a.username},{name:"cpf",label:"CPF",align:"left",field:a=>a.cpf},{name:"dataNascimento",label:"Data de nascimento",align:"left",field:a=>a.dataNascimento},{name:"email",label:"Email",align:"left",field:a=>a.email},{name:"telefone",label:"Telefone",align:"left",field:a=>a.telefone},{name:"editar",label:"Editar",align:"left",field:""}];return(a,f)=>{var k;return n.value?(m(),D("div",De,[o(xe,{flat:"",bordered:"","row-key":"id",grid:x(_),"hide-bottom":!!((k=n.value)!=null&&k.length),loading:l.loading,rows:n.value,columns:p,"rows-per-page-options":[0]},{header:t(d=>[o(we,{props:d},{default:t(()=>[(m(!0),D(I,null,F(d.cols,i=>(m(),b(ke,{key:i.name,props:d},{default:t(()=>[q(Q(i.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-editar":t(d=>[o(Ve,{props:d},{default:t(()=>[o(w,{unelevated:"",round:"",flat:"",color:"blue-8",icon:"las la-edit",onClick:i=>r("editar",d.row)},null,8,["onClick"])]),_:2},1032,["props"])]),item:t(d=>[c("div",Ue,[o(T,null,{default:t(()=>[o(ye,{dense:""},{default:t(()=>[(m(!0),D(I,null,F(d.cols,i=>(m(),b(M,{key:i.name},{default:t(()=>[o(S,null,{default:t(()=>[o(K,null,{default:t(()=>[q(Q(i.label),1)]),_:2},1024)]),_:2},1024),o(S,{side:""},{default:t(()=>[i.name==="editar"?(m(),b(w,{key:0,unelevated:"",round:"",flat:"",color:"blue-8",icon:"las la-edit",onClick:V=>r("editar",d.row)},null,8,["onClick"])):(m(),b(K,{key:1,caption:"",class:ue(i.classes?i.classes:"")},{default:t(()=>[q(Q(i.value),1)]),_:2},1032,["class"]))]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)])]),"no-data":t(()=>[l.loading?P("",!0):(m(),b(M,{key:0,class:"column items-center justify-center full-width"},{default:t(()=>[o(S,{class:"column items-center q-pa-md q-gutter-y-sm"},{default:t(()=>[o(Z,{avatar:"",name:"las la-users",color:"grey-8",size:"40px"}),Se]),_:1})]),_:1}))]),_:1},8,["grid","hide-bottom","loading","rows"])])):P("",!0)}}});function H(e){if(e===!1)return 0;if(e===!0||e===void 0)return 1;const s=parseInt(e,10);return isNaN(s)?0:s}var W=de({name:"close-popup",beforeMount(e,{value:s}){const l={depth:H(s),handler(r){l.depth!==0&&setTimeout(()=>{const n=ce(e);n!==void 0&&me(n,r,l.depth)})},handlerKey(r){pe(r,13)===!0&&l.handler(r)}};e.__qclosepopup=l,e.addEventListener("click",l.handler),e.addEventListener("keyup",l.handlerKey)},updated(e,{value:s,oldValue:l}){s!==l&&(e.__qclosepopup.depth=H(s))},beforeUnmount(e){const s=e.__qclosepopup;e.removeEventListener("click",s.handler),e.removeEventListener("keyup",s.handlerKey),delete e.__qclosepopup}});const je=()=>!0;function Le(e){const s={};return e.forEach(l=>{s[l]=je}),s}function $(){const{emit:e,proxy:s}=fe(),l=y(null);function r(){l.value.show()}function n(){l.value.hide()}function v(p){e("ok",p),n()}function _(){e("hide")}return Object.assign(s,{show:r,hide:n}),{dialogRef:l,onDialogHide:_,onDialogOK:v,onDialogCancel:n}}const ae=["ok","hide"];$.emits=ae;$.emitsObject=Le(ae);const Oe={class:"row items-center justify-between"},Re={class:"row items-baseline q-gutter-x-sm"},Pe={class:"text-h6 text-bold text-grey-9"},Ie={class:"column"},Fe={class:"column"},ze={class:"row justify-end q-gutter-x-md"},Ae=c("span",{class:"estoque-subtitle-size"},"Cancelar",-1),Be=L({__name:"EditarCadastrar",props:{usuario:{}},emits:$.emits,setup(e){const s=e,{dialogRef:l,onDialogOK:r,onDialogHide:n}=$(),v=[{label:"Administrador",value:U.ROLE_ADMIN},{label:"Usuario",value:U.ROLE_USER}],_=ee(),{mobileOrSmallWidth:p}=G(_),a=y(""),f=y(!0),k=y(),d=y(!1),i=y([U.ROLE_USER]),V=J({cpf:"",dataNascimento:"",email:"",id:0,nome:"",password:"",telefone:"",username:""}),N=C(()=>!!s.usuario),O=C(()=>!!i.value.length),te=C(()=>({password:a.value})),oe=C(()=>({password:{required:qe(()=>!N.value),minLength:Qe(8),lettersAndNumbers:()=>le(a.value.trim())}})),E=$e(oe,te),se=C(()=>{var u;return!!((u=k.value)!=null&&u.valid)&&O.value&&!E.value.$invalid});function le(u){return u?/(?=.*[0-9])(?=.*[A-Za-z])/.test(u):!0}async function ne(){try{d.value=!0;const u={tipos:i.value,usuario:V};a.value.trim()&&(u.usuario.password=a.value),N.value||delete u.usuario.id,await j.usuario.salvar.post(u),N.value?B.create({message:"Usuario atualizado com sucesso",position:"bottom",type:"positive"}):B.create({message:"Usuario criado com sucesso",position:"bottom",type:"positive"})}finally{d.value=!1,r()}}async function ie(){if(!s.usuario)return;const u=await j.usuario.buscar.get(s.usuario.id);i.value=u.object.tipos,Object.assign(V,u.object.usuario)}return X(ie),(u,g)=>(m(),b(ve,{ref_key:"dialogRef",ref:l,maximized:x(p),onHide:x(n)},{default:t(()=>[o(T,{style:{width:"100%","max-width":"600px"}},{default:t(()=>[c("div",null,[o(z,{class:"q-px-lg"},{default:t(()=>[c("div",Oe,[c("div",Re,[c("span",Pe,Q(`${u.usuario?"Editar":"Novo"} usuario`),1)]),A(o(w,{icon:"la la-close",flat:"",round:"",color:"grey-8"},null,512),[[W]])])]),_:1}),o(ge),o(T,{class:"q-mt-md q-px-md q-pb-md",flat:""},{default:t(()=>[o(Ne,{ref_key:"usuarioFormRef",ref:k,modelValue:V,"onUpdate:modelValue":g[0]||(g[0]=h=>V=h)},null,8,["modelValue"]),c("div",Ie,[o(Ce,{modelValue:i.value,"onUpdate:modelValue":g[1]||(g[1]=h=>i.value=h),outlined:"","map-options":"","emit-value":"",multiple:"",dense:"",label:"Tipos",options:v,rules:[()=>O.value||"\xC9 necessr\xE1rio selecionar o papel do usuario"]},null,8,["modelValue","rules"])]),c("div",Fe,[o(Y,{modelValue:a.value,"onUpdate:modelValue":g[3]||(g[3]=h=>a.value=h),label:"Senha",type:f.value?"password":"text","lazy-rules":"",dense:"",outlined:"",rules:[()=>!x(E).password.required.$invalid||"Campo obrigat\xF3rio",()=>!x(E).password.minLength.$invalid||"Tamanho m\xEDnimo de 8 caracteres",()=>!x(E).password.lettersAndNumbers.$invalid||"Precisa conter letras e n\xFAmeros"]},{append:t(()=>[o(Z,{name:f.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:g[2]||(g[2]=h=>f.value=!f.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"])])]),_:1})]),o(z,null,{default:t(()=>[c("div",ze,[A((m(),b(w,{"no-caps":"",flat:"",class:"text-blue-6"},{default:t(()=>[Ae]),_:1})),[[W]]),o(w,{"no-caps":"",unelevated:"",color:"secondary",loading:d.value,disable:!se.value,onClick:ne},{default:t(()=>[q(" Salvar ")]),_:1},8,["loading","disable"])])]),_:1})]),_:1})]),_:1},8,["maximized","onHide"]))}}),Ke=c("div",{class:"row justify-start q-mb-md"},[c("span",{class:"text-h6 text-bold text-grey-9"},"Usuarios")],-1),Me={class:"row justify-between q-mb-md"},sa=L({__name:"Usuarios",setup(e){const s=he(),l=y([]),r=y(!1),n=J({termo:""});async function v(){try{r.value=!0;const p=await j.usuario.pesquisar.post(n);l.value=p}finally{r.value=!1}}function _(p){s.dialog({component:Be,componentProps:{usuario:p}}).onOk(()=>{v()})}return X(async()=>{await v(),_e(n,Ee.exports.debounce(v,500))}),(p,a)=>(m(),b(be,{padding:"",class:"container"},{default:t(()=>[Ke,c("div",Me,[o(Y,{modelValue:n.termo,"onUpdate:modelValue":a[0]||(a[0]=f=>n.termo=f),label:"Termo",outlined:"",dense:""},null,8,["modelValue"]),o(w,{color:"secondary",unelevated:"","no-caps":"",label:"Novo",onClick:a[1]||(a[1]=f=>_(void 0))})]),o(Te,{modelValue:l.value,"onUpdate:modelValue":a[2]||(a[2]=f=>l.value=f),loading:r.value,onEditar:_},null,8,["modelValue","loading"])]),_:1}))}});export{sa as default};
