import{R as D,aU as P,aV as ne,a7 as G,a8 as K,o as i,aM as U,i as s,w as a,b7 as ie,aO as j,aN as L,b8 as ue,Z as w,j as n,b9 as R,aQ as re,f as p,a9 as E,Y as Z,ac as O,aR as z,V as x,ba as de,bb as me,aT as q,ab as N,aI as F,aP as ce,bc as A,aK as S,D as g,H as Y,b as Q,x as J,bd as B,at as M,aG as fe,be as pe,U as X,Q as ve,$ as T,aW as H,bf as W,bg as be,t as ge,bh as _e,_ as ye}from"./index.451ac893.js";import{a as xe,m as we,u as he}from"./index.6476bc03.js";import{_ as Ve}from"./Index.845cdedc.js";const ke={key:0},Qe={class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition"},$e=n("span",{class:"text-grey-7 text-body2"}," Nenhum usu\xE1rio encontrado ",-1),Ce=D({__name:"Index",props:P({loading:{type:Boolean,default:!1}},{modelValue:{},modelModifiers:{}}),emits:P(["editar"],["update:modelValue"]),setup(h,{emit:v}){const m=h,c=v,u=ne(h,"modelValue"),b=G(),{mobileOrSmallWidth:_}=K(b),f=[{name:"nome",label:"Nome",align:"left",field:e=>e.nome},{name:"username",label:"Username",align:"left",field:e=>e.username},{name:"cpf",label:"CPF",align:"left",field:e=>e.cpf},{name:"dataNascimento",label:"Data de nascimento",align:"left",field:e=>e.dataNascimento},{name:"email",label:"Email",align:"left",field:e=>e.email},{name:"telefone",label:"Telefone",align:"left",field:e=>e.telefone},{name:"editar",label:"Editar",align:"left",field:""}];return(e,r)=>{var V;return u.value?(i(),U("div",ke,[s(de,{flat:"",bordered:"","row-key":"id",grid:x(_),"hide-bottom":!!((V=u.value)!=null&&V.length),loading:m.loading,rows:u.value,columns:f,"rows-per-page-options":[0]},{header:a(t=>[s(ie,{props:t},{default:a(()=>[(i(!0),U(j,null,L(t.cols,l=>(i(),p(me,{key:l.name,props:t},{default:a(()=>[q(N(l.label),1)]),_:2},1032,["props"]))),128))]),_:2},1032,["props"])]),"body-cell-editar":a(t=>[s(ue,{props:t},{default:a(()=>[s(w,{unelevated:"",round:"",flat:"",color:"blue-8",icon:"las la-edit",onClick:l=>c("editar",t.row)},null,8,["onClick"])]),_:2},1032,["props"])]),item:a(t=>[n("div",Qe,[s(R,null,{default:a(()=>[s(re,{dense:""},{default:a(()=>[(i(!0),U(j,null,L(t.cols,l=>(i(),p(O,{key:l.name},{default:a(()=>[s(E,null,{default:a(()=>[s(F,null,{default:a(()=>[q(N(l.label),1)]),_:2},1024)]),_:2},1024),s(E,{side:""},{default:a(()=>[l.name==="editar"?(i(),p(w,{key:0,unelevated:"",round:"",flat:"",color:"blue-8",icon:"las la-edit",onClick:k=>c("editar",t.row)},null,8,["onClick"])):(i(),p(F,{key:1,caption:"",class:ce(l.classes?l.classes:"")},{default:a(()=>[q(N(l.value),1)]),_:2},1032,["class"]))]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)])]),"no-data":a(()=>[m.loading?z("",!0):(i(),p(O,{key:0,class:"column items-center justify-center full-width"},{default:a(()=>[s(E,{class:"column items-center q-pa-md q-gutter-y-sm"},{default:a(()=>[s(Z,{avatar:"",name:"las la-users",color:"grey-8",size:"40px"}),$e]),_:1})]),_:1}))]),_:1},8,["grid","hide-bottom","loading","rows"])])):z("",!0)}}}),qe={class:"row items-center justify-between"},Ne={class:"row items-baseline q-gutter-x-sm"},Ue={class:"text-h6 text-bold text-grey-9"},Ee={class:"column"},Se={class:"column"},Re={class:"row justify-end q-gutter-x-md"},Te=n("span",{class:"estoque-subtitle-size"},"Cancelar",-1),De=D({__name:"Index",props:{usuario:{}},emits:A.emits,setup(h){const v=h,{dialogRef:m,onDialogOK:c,onDialogHide:u}=A(),b=[{label:"Administrador",value:S.ROLE_ADMIN},{label:"Usuario",value:S.ROLE_USER}],_=G(),{mobileOrSmallWidth:f}=K(_),e=g(""),r=g(!0),V=g(),t=g(!1),l=g([S.ROLE_USER]),k=Y({cpf:"",dataNascimento:"",email:"",id:0,nome:"",password:"",telefone:"",username:""}),$=Q(()=>!!v.usuario),I=Q(()=>!!l.value.length),ee=Q(()=>({password:e.value})),ae=Q(()=>({password:{required:xe(()=>!$.value),minLength:we(8),lettersAndNumbers:()=>le(e.value.trim())}})),C=he(ae,ee),se=Q(()=>{var o;return!!((o=V.value)!=null&&o.valid)&&I.value&&!C.value.$invalid});function le(o){return o?/(?=.*[0-9])(?=.*[A-Za-z])/.test(o):!0}async function te(){try{t.value=!0;const o={tipos:l.value,usuario:k};e.value.trim()&&(o.usuario.password=e.value),$.value||delete o.usuario.id,await T.usuario.salvar.post(o),$.value?H.create({message:"Usuario atualizado com sucesso",position:"bottom",type:"positive"}):H.create({message:"Usuario criado com sucesso",position:"bottom",type:"positive"})}finally{t.value=!1,c()}}async function oe(){if(!v.usuario)return;const o=await T.usuario.buscar.get(v.usuario.id);l.value=o.object.tipos,Object.assign(k,o.object.usuario)}return J(oe),(o,d)=>(i(),p(ve,{ref_key:"dialogRef",ref:m,maximized:x(f),onHide:x(u)},{default:a(()=>[s(R,{style:{width:"100%","max-width":"600px"}},{default:a(()=>[n("div",null,[s(B,{class:"q-px-lg"},{default:a(()=>[n("div",qe,[n("div",Ne,[n("span",Ue,N(`${$.value?"Editar":"Novo"} usuario`),1)]),M(s(w,{icon:"la la-close",flat:"",round:"",color:"grey-8"},null,512),[[W]])])]),_:1}),s(fe),s(R,{class:"q-mt-md q-px-md q-pb-md",flat:""},{default:a(()=>[s(Ve,{ref_key:"usuarioFormRef",ref:V,modelValue:k,"onUpdate:modelValue":d[0]||(d[0]=y=>k=y)},null,8,["modelValue"]),n("div",Ee,[s(pe,{modelValue:l.value,"onUpdate:modelValue":d[1]||(d[1]=y=>l.value=y),outlined:"","map-options":"","emit-value":"",multiple:"",dense:"",label:"Tipos",options:b,rules:[()=>I.value||"\xC9 necessr\xE1rio selecionar o papel do usuario"]},null,8,["modelValue","rules"])]),n("div",Se,[s(X,{modelValue:e.value,"onUpdate:modelValue":d[3]||(d[3]=y=>e.value=y),label:"Senha",type:r.value?"password":"text","lazy-rules":"",dense:"",outlined:"",rules:[()=>!x(C).password.required.$invalid||"Campo obrigat\xF3rio",()=>!x(C).password.minLength.$invalid||"Tamanho m\xEDnimo de 8 caracteres",()=>!x(C).password.lettersAndNumbers.$invalid||"Precisa conter letras e n\xFAmeros"]},{append:a(()=>[s(Z,{name:r.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:d[2]||(d[2]=y=>r.value=!r.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"])])]),_:1})]),s(B,null,{default:a(()=>[n("div",Re,[M((i(),p(w,{"no-caps":"",flat:"",class:"text-blue-6"},{default:a(()=>[Te]),_:1})),[[W]]),s(w,{"no-caps":"",unelevated:"",color:"secondary",loading:t.value,disable:!se.value,onClick:te},{default:a(()=>[q(" Salvar ")]),_:1},8,["loading","disable"])])]),_:1})]),_:1})]),_:1},8,["maximized","onHide"]))}}),Ie=n("div",{class:"row justify-start q-mb-md"},[n("span",{class:"text-h6 text-bold text-grey-9"},"Usuarios")],-1),Pe={class:"row justify-between q-mb-md"},ze=D({__name:"Usuarios",setup(h){const v=be(),m=g([]),c=g(!1),u=Y({termo:""});async function b(){try{c.value=!0;const f=await T.usuario.pesquisar.post(u);m.value=f}finally{c.value=!1}}function _(f){v.dialog({component:De,componentProps:{usuario:f}}).onOk(()=>{b()})}return J(async()=>{await b(),ge(u,_e.exports.debounce(b,500))}),(f,e)=>(i(),p(ye,{padding:"",class:"container"},{default:a(()=>[Ie,n("div",Pe,[s(X,{modelValue:u.termo,"onUpdate:modelValue":e[0]||(e[0]=r=>u.termo=r),label:"Termo",outlined:"",dense:""},null,8,["modelValue"]),s(w,{color:"secondary",unelevated:"","no-caps":"",label:"Novo",onClick:e[1]||(e[1]=r=>_(void 0))})]),s(Ce,{modelValue:m.value,"onUpdate:modelValue":e[2]||(e[2]=r=>m.value=r),loading:c.value,onEditar:_},null,8,["modelValue","loading"])]),_:1}))}});export{ze as default};
